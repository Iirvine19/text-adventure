<h2>Hunt for Haken</h2>
<br /><br />
<div id="text"></div>
<input id="input" />
<script
  type="text/javascript"
  src="http://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"
></script>
<script>
  var affirmative = [
    "yup",
    "yep",
    "yes",
    "delighted",
    "all right",
    "alright",
    "very well",
    "of course",
    "by all means",
    "sure",
    "certainly",
    "absolutely",
    "indeed",
    "affirmative",
    "affirmative",
    "agreed",
    "roger"
  ];
  var negative = ["nix", "no", "nada", "negative", "naw", "nay"];
  var inventory = ["sword", "shield", "insignia"];
  var bman = 0;
  var oldman = 0;
  var revents = 0;
  var inn = 0;
  var standCounter = 0;
  var text = document.getElementById("text");
  var pClass = null;
  var currentRoom = 0;
  var currentChoice = 0;
  var body = document.getElementsByTagName("body")[0];
  var input = document.getElementById("input");

  function clearInput() {
    $("#input").val("");
  }
  text.innerHTML =
    "Welcome! You are a " +
    "Paladin of the Sun".fontcolor("gold") +
    ", a noble order who fight for good across the known world. Do you come from the school of Fighting or the school of Diplomacy?";
  function addText(s) {
    var div = $('<div id="text2">' + s + "</div>");
    $("#text").append(div);
  }
  function addDlg(s) {
    var div = $('<div id="text2">' + s.fontcolor("blue") + "</div>");
    $("#text").append(div);
  }
  function paladinText(s) {
    var div = $(
      '<div id="text2">' +
        "You: ".fontcolor("Gold") +
        s.fontcolor("gold") +
        "</div>"
    );
    $("#text").append(div);
  }
  var state = "intro";
  $("#input").keypress(function() {
    if (event.which !== 13) {
      return;
    }

    var inputTxt = $("#input").val();
    var sinputTxt = inputTxt.toLowerCase();
    clearInput();
    function YN() {
      if (affirmative.includes(sinputTxt)) {
        return true;
      } else if (negative.includes(sinputTxt)) {
        return false;
      }
    }
    switch (state) {
      //Introduction and Class selection
      case "intro":
        if (sinputTxt.includes("fight")) {
          addText("You're a fighter!");
          pClass = "fighter";
        } else if (sinputTxt.includes("dip")) {
          addText("You're a diplomat!");
          pClass = "diplomat";
        } else {
          addText("try again!");
        }
        if (pClass !== null) {
          state = "town1";
          addText(
            "Well, " +
              pClass +
              ", let me fill you in on what's happening. You are currently searching for a missing member of your order named Haken. The path has lead you to a town called Chaepstow. You have just ridden into town as the sun is setting and you see an inn and a man leaning on a wall by the side of the road. Which do you approach?"
          );
        }
        break;
      //Arrival in town
      case "town1":
        if (sinputTxt.includes("man") || sinputTxt.includes("wall")) {
          addText("You approach the man on the wall".fontcolor("red"));
          state = "wallman";
          addText(
            "The man looks up as you approach, but says nothing.".fontcolor(
              "red"
            ) +
              " What do you want to ask him about? 1. The town	 2. Haken  3. Himself"
          );
        } else if (sinputTxt.includes("inn")) {
          addText("To the inn! Press enter to continue.");
          state = "inn1";
        } else {
          addText("try again!");
        }
        break;
      //Talking to Gary
      case "wallman":
        oldman = 1;
        if (sinputTxt.includes("1") || sinputTxt.includes("town")) {
          paladinText(
            "Pardon me, sir, but can you tell me about the town I've just entered?"
          );
          addDlg(
            "Man: Well, son, you're in the town of Chaepstow. I hope you don't plan on staying too long."
          );
          addText(
            "The man seems pretty hostile. Perhaps you'll find someone friendlier at the inn. Do you want to go there now?"
          );
          state = "innchoice";
        } else if (sinputTxt.includes("2") || sinputTxt.includes("haken")) {
          console.log(pClass);

          paladinText(
            "Pardon me sir, I'm searching for a friend. Have any travellers come through recently, perhaps dressed like me?"
          );
          addDlg(
            "Man: Sure, we've had travellers. Maybe they were like you, maybe not. I hope you don't stay long enough I hafta find out."
          );
          addText(
            "The man obviously doesn't want to talk to you. Perhaps you'll have better luck at the inn. Do you want to go there now?"
          );
          state = "innchoice";
        } else if (
          sinputTxt.includes("attack") ||
          sinputTxt.includes("fight") ||
          sinputTxt.includes("stab") ||
          sinputTxt.includes("kill")
        ) {
          addText(
            "The old man dies easily, a single blow to his throat. As he collapses to the ground you hear him say".fontcolor(
              "red"
            ) + " 'So, you are like the others.'".fontcolor("blue")
          );
          addText(
            "Suddenly you hear a door slam open. There's a man holding a knife looking at you from his doorway.".fontcolor(
              "red"
            )
          );
          addDlg("Help, Help! He killed Gary! The stranger killed Gary!");
          addText(
            "It's a small village and the man has a big voice. A crowd gathers very quicly, many of them holding knives or axes. Do you fight them or do you run?"
          );
          state = "mob";
        } else if (sinputTxt.includes("3") || sinputTxt.includes("him")) {
          paladinText("Greetings, sir! How may I call you?");
          addDlg("Man: You mayn't. Get on.");
          if (pClass === "diplomat") {
            state = "dip1";
            addText("Do you want to sweet talk the man?");
          } else if (pClass === "fighter") {
            console.log(pClass);
            addText(
              "The man obviously doesn't want to talk to you. Perhaps you'll have better luck at the inn. Do you want to go there now?"
            );
            state = "innchoice";
          }
        } else {
          console.log(sinputTxt);
          addText("try again!");
        }
        break;
      //Talking to Gary More
      case "dip1":
        if (YN() === true) {
          paladinText(
            "Please, sir, I mean you no offense, nor harm. I'm merely trying to complete a mission for my order"
          );
          addDlg(
            "Man: I couldn't care less about your order. The only order I care about is the order of my town. And I don't want it disturbed!"
          );
          addText(
            "The man obviously doesn't want to talk to you. Perhaps you'll have better luck at the inn. Do you want to go there now?"
          );
          state = "innchoice";
        } else if (YN() === false) {
          addText(
            "Good choice. The man obviously doesn't want to talk to you. Perhaps you'll have better luck at the inn. Do you want to go there now?"
          );
          state = "innchoice";
        } else if (
          sinputTxt.includes("attack") ||
          sinputTxt.includes("fight") ||
          sinputTxt.includes("stab") ||
          sinputTxt.includes("kill")
        ) {
          addText(
            "The old man dies easily, a single blow to his throat. As he collapses to the ground you hear him say".fontcolor(
              "red"
            ) + " 'So, you are like the others.'".fontcolor("blue")
          );
          addText(
            "Suddenly you hear a door slam open. There's a man holding a knife looking at you from his doorway.".fontcolor(
              "red"
            )
          );
          addDlg("Help, Help! He killed Gary! The stranger killed Gary!");
          addText(
            "It's a small village and the man has a big voice. A crowd gathers very quicly, many of them holding knives or axes. Do you fight them or do you run?"
          );
          state = "mob";
        } else {
          addText("try again");
        }
        break;
      //Going to the inn?
      case "innchoice":
        if (standCounter <= 5) {
          if (sinputTxt.includes("inn") || YN() === true) {
            addText("Good choice.");
            state = "inn1";
          } else if (
            sinputTxt.includes("stay") ||
            sinputTxt.includes("standing") ||
            sinputTxt.includes("keep") ||
            sinputTxt.includes("road") ||
            YN() === false
          ) {
            standCounter++;
            addText(
              "You keep standing in the road. Nothing much is happening. The old man won't acknowledge you".fontcolor(
                "red"
              ) + " Do you want to go to the inn now?"
            );
            state = "standing";
          } else if (
            sinputTxt.includes("attack") ||
            sinputTxt.includes("fight") ||
            sinputTxt.includes("stab") ||
            sinputTxt.includes("kill")
          ) {
            addText(
              "The old man dies easily, a single blow to his throat. As he collapses to the ground you hear him say".fontcolor(
                "red"
              ) + " 'So, you are like the others.'".fontcolor("blue")
            );
            addText(
              "Suddenly you hear a door slam open. There's a man holding a knife looking at you from his doorway.".fontcolor(
                "red"
              )
            );
            addDlg("Help, Help! He killed Gary! The stranger killed Gary!");
            addText(
              "It's a small village and the man has a big voice. A crowd gathers very quicly, many of them holding knives or axes. Do you fight them or do you run?"
            );
            state = "mob";
          } else {
            addText("try again");
          }
        } else {
          addText(
            "Minutes turn to hours turn to days as you refuse to move. The weather changes, winter comes and goes, the only constant is you. Slowly you turn to rock, a blessing from your god, impressed with your stoicness. Eventually no one remembers that the statue used to be a real man."
          );
          state = "gameover";
        }
        break;
      //Didn't go to the inn
      case "standing":
        if (standCounter <= 5) {
          if (sinputTxt.includes("inn") || YN() === true) {
            addText("Good choice.");
            state = "inn1";
          } else if (
            sinputTxt.includes("stay") ||
            sinputTxt.includes("standing") ||
            sinputTxt.includes("keep") ||
            sinputTxt.includes("road") ||
            YN() === false
          ) {
            standCounter++;
            addText(
              "You keep standing in the road. Nothing much is happening. The old man won't acknowledge you".fontcolor(
                "red"
              ) + " Do you want to go to the inn now?"
            );
            state = "innchoice";
          } else if (
            sinputTxt.includes("attack") ||
            sinputTxt.includes("fight") ||
            sinputTxt.includes("stab") ||
            sinputTxt.includes("kill")
          ) {
            addText(
              "The old man dies easily, a single blow to his throat. As he collapses to the ground you hear him say".fontcolor(
                "red"
              ) + " 'So, you are like the others.'".fontcolor("blue")
            );
            addText(
              "Suddenly you hear a door slam open. There's a man holding a knife looking at you from his doorway."
            ).fontcolor("red");
            addDlg("Help, Help! He killed Gary! The stranger killed Gary!");
            addText(
              "It's a small village and the man has a big voice. A crowd gathers very quicly, many of them holding knives or axes. Do you fight them or do you run?"
            );
            state = "mob";
          } else {
            addText("try again");
          }
        } else {
          addText(
            "Minutes turn to hours turn to days as you refuse to move. The weather changes, winter comes and goes, the only constant is you. Slowly you turn to rock, a blessing from your god, impressed with your stoicness. Eventually no one remembers that the statue used to be a real man."
          );
          state = "gameover";
        }
        break;
      //Killed Gary. Idiot.
      case "mob":
        if (sinputTxt.includes("fight") || sinputTxt.includes("kill")) {
          addText(
            "Foolishly you try to fight them. You charge on your horse, laying about you with your blade. One, two, three fall, but it's not enough. You are dragged from your horse, and beaten to death in the street.".fontcolor(
              "red"
            )
          );
          addText("A fitting end for a paladin turned murderer of elders.");
          state = "gameover";
        } else if (
          sinputTxt.includes("run") ||
          sinputTxt.includes("flee") ||
          sinputTxt.includes("book it")
        ) {
          addText(
            "You turn your horse to try to flee but an flung axe strikes you in the back of the head. Not expecting combat your feet were not in the stirrups and you are knocked from your horse. The crowd is on you in an instant, and you are beaten to death in the street.".fontcolor(
              "red"
            ) +
              " As the final blow is brought down on your head you hear" +
              " 'This one's for Mark!'".fontcolor("blue")
          );
          addText(
            "'Who's Mark?'you wonder, but only for as long as it takes the axe to fall."
          );
          state = "gameover";
        }
        break;
      //Game is over
      case "gameover":
        addText(
          "I'm afraid that's the end of your journey, friend. You didn't choose quite right. See you 'round."
        );
        addText("Play again?");
        state = "restart";
        break;
      //Restart option
      case "restart":
        if (YN() === true) {
          text.innerHTML =
            "Welcome! You are a " +
            "Paladin of the Sun".fontcolor("gold") +
            ", a noble order who fight for good across the known world. Do you come from the school of Fighting or the school of Diplomacy?";
          state = "intro";
        } else if (YN() === false) {
          addText("Right. Have a good day then.");
        } else {
          addText("try again");
        }
      //START OF INN BRANCHES
      //In the inn
      case "inn1":
        function barman() {
          console.log("barman!");
          if (bman === 0) {
            bman = 1;
            if (oldman === 0) {
              addText(
                "Do you want to ask the Barman about 1. Haken, 2. Lodging, 3. The town, or 4. Himself?"
              );
              inn = 1;
            } else if (oldman !== 0) {
              addText(
                "Do you want to ask the Barman about 1. Haken, 2. Lodging, 3. The town, 4. Himself, or 5. The old man?"
              );
              inn = 1;
            }
          } else {
            if (sinputTxt.includes("1") || sinputTxt.includes("hak")) {
              paladinText(
                "Greetings, Barman! I'm searching for another member of my order, a man named Haken. Have any travellers dressed like me come through here? Anyone with this insignia?"
              );
              addText(
                "You reach to remove the shield from your back, but the Barman jumps, so instead you point to the sun crest on your shirt".fontcolor(
                  "red"
                )
              );
              addDlg(
                "Barman: Ah, well, no I haven't seen any travellers like you, certainly no one with a name like Haken. There were some people come through recently but...".fontcolor(
                  "blue"
                )
              );
              addText(
                "The Barman pauses for a moment then shakes his head slightly".fontcolor(
                  "red"
                )
              );
              addDlg(
                "Barman: Nevermind them. You don't want anything to do with them."
              );
              addText("Do you want to ask about the travellers?");
              state = "bartravellers";
            } else if (
              oldman !== 0 &&
              (sinputTxt.includes("5") ||
                sinputTxt.includes("man") ||
                sinputTxt.includes("old"))
            ) {
              paladinText(
                "I met a very unwelcoming old man in the road outside. Is he always like that?"
              );
              addDlg(
                "Barman: Ah, that was probably Gary. Well, I won't say he usually goes out of his way for strangers, but with recent events especially I can see that he would've been unkind to you. Sorry bout him, everyone's a bit on edge."
              );
              revents = 1;
            } else if (
              sinputTxt.includes("2") ||
              sinputTxt.includes("lodging") ||
              sinputTxt.includes("room") ||
              sinputTxt.includes("night")
            ) {
              paladinText("Do you have a room? I'm looking to stay the night");
              addDlg("Barman: I'm not sure. I'll have to check with the wife");
              addText(
                "He looks away from you as he says this and you get the sense that he isn't being entirely truthful.".fontcolor(
                  "red"
                )
              );
            } else if (sinputTxt.includes("3") || sinputTxt.includes("town")) {
              paladinText(
                "Greetings, barman, what can you tell me about this town?"
              );
              addDlg(
                "Barman: Well, there's not really too much to tell. We're a quiet town, usually. Not very big. Course, hasn't been terribly quiet recently, but..."
              );
              revents = 1;
              addText(
                "The barman trails off, chuckling nervously.".fontcolor("red")
              );
            } else if (
              sinputTxt.includes("4") ||
              sinputTxt.includes("him") ||
              sinputTxt.includes("bar")
            ) {
              paladinText(
                "It's nice to meet you, good sir. What should I call you? And what do you do in this town?"
              );
              addDlg(
                "Barman: Oh just call me barman, my name doesn't matter. As you can probably tell I own this inn. I run the bar, and my wife cooks. We both deal with roomers."
              );
            } else if (
              revents === 1 &&
              (sinputTxt.includes("recent") || sinputTxt.includes("event"))
            ) {
              paladinText("Recent events? What happened");
              addDlg(
                "Barman: I'm sorry, excuse me a moment. I need to talk to my wife."
              );
              addText(
                "The barman turns and almost runs into the kitchen.".fontcolor(
                  "red"
                ) + " What do you do?"
              );
              state = "thewife";
            } else if (sinputTxt.includes("wife")) {
              paladinText("Your wife? Tell me about her.");
              addText("The Barman smiles".fontcolor("red"));
              addDlg(
                "Barman: Ah yes, my wife. We've been married twenty years, and been runnin' this inn together for most of it. She's tough as nails she is, and terrible to get in an argument with, But I love her dearly. She'll be cookin' you breakfast if you stay the night, and you can buy dinner too if you like."
              );
              addText(
                "Do you want to get dinner here? It'es probably nicer than what you've got back on the horse."
              );
              state = "dinner?";
            } else if (sinputTxt.includes("no")) {
              addText(
                "You decide to let the travellers thing go, it obviously makes him nervous. Maybe ask about his wife?"
              );
            } else {
              addText("Try again");
            }
          }
        }
        if (inn === 0) {
          addText("A man at the bar looks up as you enter.".fontcolor("red"));
          addText(
            "Barman: Greetings, traveller. What can I do for you?".fontcolor(
              "blue"
            )
          );
          inn = 1;
          barman();
        } else if (inn !== 0) {
          barman();
        }
        break;
      //BARMAN WENT TO TALK TO WIFE
      case "thewife":
        if (sinputTxt.includes("wait") || sinputTxt.includes("stay")) {
          addText(
            "You wait a minute. Then another. Then about ten more. You're beginning to wonder if he's coming back."
          );
        } else if (
          sinputTxt.includes("follow") ||
          sinputTxt.includes("go") ||
          sinputTxt.includes("after")
        ) {
          state = "thewife2";
          addText(
            "You follow the barman around behind the bar, starting to call after him when you're suddenly interrupted by four and a half feet of fury".fontcolor(
              "red"
            )
          );
          addDlg(
            "The Wife: Who do you think you are, coming up behind my husband like that. Get back you hooligan!"
          );
          addText(
            "She turns to her husband who has somehow ended up behind her".fontcolor(
              "red"
            )
          );
          addDlg(
            "The Wife: Is he another like the ones the other day? Do I need to get rid of him?"
          );
          addDlg(
            "Barman: No, no, thank you dear. He's just a little...overzealous. He was lookin for somewhere to stay the night on his search for a missing friend. I came back to ask you if that was alright."
          );
          addDlg(
            "The Wife: Well, what do you have to say for yourself, coming back here all dressed up in armor like that, scaring a poor woman half to death."
          );
          addText("Do you defend yourself or apologize?");
        } else if (
          sinputTxt.includes("look") ||
          sinputTxt.includes("examine")
        ) {
          addText(
            "The main room looks pretty nice for a small town like this. Three small tables set with four chairs each, and a larger central table with six seats. The table in the back left seems to have something shiny on it, do you want to check it out?"
          );
          state = "findtable";
        } else {
          addText("try again!");
        }
        break;
      //checking out the table
      case "findtable":
        if (YN() === false) {
          addText("Alright, well the barman's still not back. What do you do?");
          state = "thewife";
        } else if (YN() === true) {
          addText(
            "You rise and walk over to the table.".fontcolor("red") +
              " The shiny object on closer examination is a polished copper ring. It has no markings but is warm to the touch as if someone had just removed it."
          ); //UWU it's magic. What does it do? Who knows I hope I figure it out.
          addText("Do you take it?");
          state = "foundring";
        } else {
          addText("try again!");
        }
        break;
      //OwO magic ring. Do you take it?
      case "foundring":
        if (
          sinputTxt.includes("pick") ||
          sinputTxt.includes("pocket") ||
          sinputTxt.includes("take") ||
          YN() === true
        ) {
          inventory.push("ring");
          console.log(inventory);
          addText(
            "You take the ring and slip it into your pocket. Hopefully you'll remember it's there.".fontcolor(
              "red"
            )
          );
          addText(
            "You look up as you hear the barman come back into the main room. He has a woman with him who you assume is his wife.".fontcolor(
              "red"
            )
          );
        } else if (YN() === false) {
          addText(
            "You leave the ring there. Hopefully it's rightful owner will return. Scavenging jewelry does not befit a paladin.".fontcolor(
              "red"
            )
          );
          addText(
            "You look up as you hear the barman come back into the main room. He has a woman with him who you assume is his wife.".fontcolor(
              "red"
            )
          );
          addText(
            "The woman beckons you over, and you walk up to the bar.".fontcolor(
              "red"
            )
          );
          addDlg(
            "The Wife: So, I hear you're looking for someone, and want to know about the travellers who came through the other day."
          );
          paladinText("Yes, can you tell me anything about that?");
          addDlg(
            "The Wife: I tell you what. If you stay for dinner with us, and clean the kitchen up afterwards, then I'll tell you what I know. Sound like a deal?"
          );
          state = "workforinfo";
        } else {
          addText("try again!");
        }
        break;
      //You'll get your info, if you work for the wife.
      case "workforinfo":
        if (YN()===true|| sinputTxt.includes("stay")|| sinputTxt.includes("dinner")){
          addDlg("The wife: Great. I'm Edna. Go on upstairs and I'll give you a shout when dinner's ready.")
          case = "inn2"
        }else if (YN()===false){
          case = "closedinn"
          paladinText("Work in the kitchen, to learn something that might be useless? I don't think so.")
          addDlg("The Wife: I hope you don't plan on staying the night, then. The inn is closed.")
          addText("Harold escorts you to the door.".fontcolor("red"))
        }else {
          addText("try again")
        }
        break;
      //UH OH SHE MAD. UNFINISHED
      case "thewife2":
        if (
          sinputTxt.includes("apologize") ||
          sinputTxt.includes("sorry") ||
          sinputTxt.includes("regret")
        ) {
          paladinText(
            "Please excuse me ma'am, I'm just trying to complete my mission. I'm terribly sorry if I frightened you."
          );
          addDlg(
            "The Wife: don't be absurd, it would take a lot more than that to scare me."
          );
          addText("The Wife turns to her husband").fontcolor("red");
          addDlg("The Wife: Is he staying for dinner?");
          addDlg("The Barman: I don't know.");
          addText("He turns to you").fontcolor("red");
          addDlg("The Barman: Are you?");
          state = "dinner?";
        } else if (sinputTxt.includes("defend")) {
          paladinText(
            "How else would I dress? I am a Paladin of the Sun, on the hunt for a missing member of my order. And he became very suspicious when I asked him about recent events and travellers."
          );
          addDlg(
            "The Wife: Right, get out. Don't need more troublemakers in this town, the last bunch were more than enough."
          );
          state = "closedinn";
        } else if (
          sinputTxt.includes("attack") ||
          sinputTxt.includes("fight") ||
          sinputTxt.includes("stab") ||
          sinputTxt.includes("kill")
        ) {
          addText(
            "You reach for your sword to attack this woman, but she is much faster that you expected. Before your sword clears its sheath the knife in her hand has found its own: your throat. Your hands go to your neck and you topple to the ground, dead."
          );
          addText(
            "Really, that's what you get for such unpaladin-like behavior."
          );
          state = "gameover";
        } else {
          addText("try again");
        }
        break;
      //OWO WHAT'RE THESE TRAVELLERS?
      case "bartravellers":
        if (YN() === true) {
          paladinText(
            "You've had trouble with travellers recently? When were they through?"
          );
          addDlg("Barman: Now I didn't say that. I...");
          addText(
            "The Barman trails off, looking unsure. Do you want to keep pushing him?"
          );
          state = "dipcheck1";
        } else if (YN() === false) {
          addText("Yeah, probably best not to push.");
          state = "inn1";
          barman();
        } else {
          addText("try again!");
        }
        break;
      //DIPLOMACY CHECK. DO YOU TALK GOOD?
      case "dipcheck1":
        if (YN() === true || sinputTxt.includes("push")) {
          if (pClass === "diplomat") {
            paladinText(
              "Good sir, I can see that you're concerned, but I assure you that I wish you no harm. I merely want to find the missing member of my order. Please tell me about the travellers who came through here."
            );
            addText(
              "The Barman looks unsure for another moment, then you can see him make up his mind."
            );
            addDlg(
              "Barman: Alright, you seem trustworthy. A few nights ago we had some travellers come through, a group of five men with a covered wagon. I think there was someone in the wagon as well, a prisoner, because a few times during the night it shook violently, and they brought food out to it in the morning. Gary's son challenged them about it when they were leaving, and they told him it was none of his business. Unfortunately, Mark's as hard headed as his father, so he tried to stop 'em leaving. The  guy pulled a dagger and slammed the pommel down on his head real hard. He's been in and out of consciousness since then. Plus they torched a barn on the way out of town, just to hurt us when we did nothing to them."
            );
            paladinText(
              "I'm sorry, that's a terrible tragedy. I will pray for Mark tonight. As to the men who did this, I would like to pursue them, do you know where they went?"
            );
            addDlg(
              "Barman: They left town to the North. Everard was out hunting the night after they left and he said that they some of them holed up in a cave a few miles Northwest, and the others continued up the North Road. Stay the night, and I'll have him come over tomorrow morning and you can talk."
            );
            addText(
              "Do you stay the night to talk to Everard or begin pursuit right now?"
            );
            state = "staychoice";
          } else if (pClass !== "diplomat") {
            paladinText(
              "Listen, if you've had trouble with marauders or anything like that, I could deal with them. I'm a paladin of the Sun, from the school of fighting, I can take anyone."
            );
            addText(
              "The Barman shakes his head. This was obviously the wrong path.".fontcolor(
                "red"
              )
            );
            addDlg(
              "Barman: No. No more violence Actually, I'm sorry, the Inn is closed tonight. Please get out."
            );
            addText(
              "Well, you got kicked out of the inn. Another night roughing it you suppose.  In the morning you'll try to find more information. Tonight you eat more hard bread and bunk down under the stars."
            );
            addText("Press enter to continue.");
            state = "closedinn";
          }
        } else if (YN() === false) {
          paladinText(
            "Very well, I see you don't want to talk about it. I'll respect that but please know that it would help a lot."
          );
          addDlg(
            "Barman: Well...I'll tell you what. You get dinner and a room here, and I'll see if my wife likes you. If she does, I'll tell you everything I know. Thank you for not pushing."
          );
          state = "inn2";
          addText("Will you stay for dinner?");
        } else {
          addText("try again!");
        }
        break;
      case "staychoice":
        if (
          sinputTxt.includes("stay") ||
          sinputTxt.includes("eve") ||
          sinputTxt.includes("sleep")
        ) {
          paladinText("I will stay the night, and meet your friend in the morning. Thank you again for your hospitality.")
          addDlg("Harold: Our pleasure.")
          addText("You follow Edna back into the kitchen and help her clean up after dinner. You then go up to your room, and go to sleep.")
          addText("Press enter for the next day to start.")
          state = "meetEverard"
        } else if (
          sinputTxt.includes("purs") ||
          sinputTxt.includes("follow") ||
          sinputTxt.includes("chase") ||
          sinputTxt.includes("tonight")
        ) {
          addText(
            "You decide that you cannot allow your quarry to continue to get ahead of you."
          );
          paladinText(
            "Thank you kindly for your hospitality and your help, but I must get after these fiends as soon as I can."
          );
          addDlg(
            "Barman: Very well. I wish you luck. Will you start with the cave to the Northwest, or pursue the others on the North road?"
              state = "leavingtown";
          );
        } else {
          addText("try again!");
        }

      case "inn2":
        if (YN === true) {
          addText(
            "Dinner turns out to be a delicious chicken stew, and some good, thick bread."
          );
          paladinText(
            "My compliments, m'lady. This meal rivals those I've eaten at a Baron's table, and I couldn't ask for more in terms of hospitality."
          );
          addText("The Barman's wife blushes");
        } else if (YN === false) {
          addText("You choose not to spend the night. God only knows why given you were promised the info you wanted.");
          state = "closedinn";
        } else {
          addText("try again");
        }
        break;
      //Gonna get dinner?
      case "dinner?":
        if (
          YN() === true ||
          sinputTxt.includes("stay") ||
          sinputTxt.includes("dinner")
        ) {
          paladinText(
            "I would love to stay for dinner. What's your wife making?"
          );
          addDlg(
            "Barman: Actually you've chosen a great night to come. One of our hens wasn't laying anymore, so we've got chicken stew tonight."
          );
          state = "dinner.";
          addText(
            "You choose to stay for dinner, and pay for dinner and a room. You head upstairs and get your things settled into your room. You don't plan on staying long, but it looks like rain so you want your things inside. Your horse is safely stabled, and all is well."
          );
          setTimeout(
            addText("After about an hour there's a knock on your door"),
            300
          );
          addDlg("Barman: Dinner's ready, come join us!");
          addText(
            "You rise, open the door, and follow the Barman down to the dinner table.".fontcolor(
              "red"
            ) +
              " The stew smells delicious and there is good, thick bread to go with it. Dinner is mostly silent, until the Barman's wife speaks up."
          );
          addDlg(
            "The Wife: So, you want to know about the people who came through here the other day? Well, you seem trustworthy. I'm Edna, and that's Harold."
          );
          addText("Harold nods to you, and you smile back.".fontcolor("red"));
          setTimeout(
            paladinText(
              "It's nice to learn the names of such pleasant hosts. Thank you for the delicious meal."
            ),
            300
          );
          addText("Edna smiles at the compliment".fontcolor("red"));
          addDlg(
            "Edna: Well, about the people who came through the other day. It was a group of five rough men, travelling with a covered wagon. Harold thinks they had someone they were keeping in it. "
          );
          addText(
            "Harold nods, adding: ".fontcolor("red") +
              "They brought food out to the wagon, and during the night it got up to some awful shaking until one of them went out and stopped it.".fontcolor(
                "Blue"
              )
          );
          paladinText("A prisoner? Did anyone see him?");
          addDlg(
            "Edna: No. Gary's son, Mark tried to stop them on their way out of town, but one of those terrible men just hit him in the head with the pommel of his dagger. Poor Mark, he fell to the ground and he's hardly been up since. And those evil men just rode away north, laughing."
          );
          addDlg(
            "Harold: My friend Everard says he's seen 'em up by the goblin cave, some of 'em. But the others went on North. You can go after them in the morning, but please stay the night. I'll bring Everard over to talk in the morning."
          );
          addText(
            "Do you stay the night to talk to Everard or begin pursuit right now?"
          );
          state = "staychoice";
        } else if (YN() === false) {
          addText(
            "Suit yourself. You're missing out though. Would it change your mind if I reminded you you're travelling on the order's coin?"
          );
          state = "dblchk";
        } else {
          addText("try again!");
        }
        break;

      case "meetEverard":
          //MEETING EVERARD
        break;
      case "dinner.":
        break;
      //YA GOT KICKED OUT or chose not to stay
      case "closedinn":
        addText(
          "With the inn no longer an option you spend the night beneath the stars, a little ways outside town. You prepare your campsite and after a bland dinner of hard bread and cheese you go to sleep. In the morning you can try again, maybe you'll have better luck with someone else"
        );
        var x = Math.floor(Math.random() * 10 + 1);
        if (x > 8) {
          state = "surprisebear";
          addText(
            "You awaken in the dead of night to your horse whinnying loudly and nervously. Your fire has burnt out and with the clouds the night is black as pitch.".fontcolor(
              "red"
            ) + " Do you ignore it or light a torch?"
          );
        } else {
          addText(
            "In the morning you rise and pack your bags. You walk towards town, and on the way you run into a man setting a rabbit snare, who jumps when he notices you."
          ).fontcolor("red");
          addDlg(
            "Hunter: Oh, hello there. I was just checking what that was, and it's, umm. It's a rabbit snare you know, you should get rid of it, a man of the law like you."
          );
          addText(
            "As the Hunter babbles you remember that the baron of this region declared all the land his land, and madde hunting on it illegal. "
          );
          //  state =
        }
        //END OF INN BRANCHES
        break;
      case "surprisebear":
        if (sinputTxt.includes("sleep") || sinputTxt.includes("ignore")) {
          addText(
            "Your horse's whinnies grow louder and more scared but you're too tired to deal with it. You pull a blanket over your head and go back to sleep"
          ).fontcolor("red");
        } else if (sinputTxt.includes("torch") || sinputTxt.includes("light")) {
          addText(
            "You scrabble around for your tinder box and, after a few tries, your torch flairs to life.".fontcolor(
              "red"
            )
          );
          addText(
            "In the light of the torch you can see a large bear digging into your food supplies. Do you fight it, try to scare it off, or just let it be? It is quite a large bear."
          );
          state = "bearfight";
        } else {
          addText("try again!");
        }
        break;
      case "bearfight":
        if (
          sinputTxt.includes("fight") ||
          sinputTxt.includes("kill") ||
          sinputTxt.includes("attack")
        ) {
          addText(
            "You grab your sword and yell at the bear to get its attention. Afterall stabbing it in the ass isn't likely to do anything but make it angry."
          ).fontcolor("red");
          // LUNCH BREAK BUT IF YOU'RE SCHOOL OF FIGHTING YOU SUCCEED IF NOT YOU FAIL
          if (pClass === "fighter") {
            addText(
              "You lunge at the bear as it turns towards you, and you're lucky enough to catch it under the chin. The bear lies dead, and you give thanks to your God over its body.".fontcolor(
                "red"
              )
            );
            addText(
              "Perhaps you should offer the Bear to the town, as a peace offering, and hope they'll tell you about the people who came through."
            );
          } else {
            addText(
              "You swing your sword at the bear's throat, but miss, glancing off the skull. The bear roars in pain and anger, and rears up on its back legs.".fontcolor(
                "red"
              )
            );
            var x = Math.floor(Math.random() * 10 + 1);
            if (x > 7) {
              addText(
                "You take advantage of the bear's new state, and twist your blade around and up, jamming it through the bottom of the bear's jaw, killing it. The bear lies dead, and you give thanks to your God over its body.".fontcolor(
                  "red"
                )
              );
              addText(
                "Perhaps you should offer the Bear to the town, as a peace offering, and hope they'll tell you about the people who came through."
              );
            } else if (x <= 7) {
              addText(
                "The bear brings its massive weight down on your unprotected chest, knocking you to the ground and crushing your lungs. It then goes for the throat and the last thing you see is a massve pair of bear jaws clamping themselves to your defenseless neck. You are dead."
              );
              state = "gameover";
            }
          }
        } else if (sinputTxt.includes("yell") || sinputTxt.includes("scare")) {
          addText(
            "You yell at the bear, waving your torch towards it. It looks up, surprised, and decides your old cheese isn't worth it. The bear flees.".fontcolor(
              "red"
            )
          );
          addText(
            "Congratulations, you scared off a bear. Next time remember to hang your food up."
          );
          //state = "";
        } else if (
          sinputTxt.includes("ignore") ||
          sinputTxt.includes("let") ||
          sinputTxt.includes("sleep")
        ) {
          addText(
            "Your horse's whinnies grow louder and more scared but you're too tired to deal with it. The bear doesn't want a fight, and neither do you. You pull a blanket over your head and go back to sleep"
          ).fontcolor("red");
        } else {
          addText("try again");
        }
        break;
      case "dblchk":
        if (YN() === true) {
          addText("Alright, if you're sure.");
          state = "closedinn";
        } else if (YN() === false) {
          addText("Right choice.");
          addText("Say yes please to go to dinner");
        } else {
          addText("try again!");
        }
        break;
      case "leavingtown":
      if (/*North Pursuit*/){
        paladinText("I must follow the up the North road. I feel that their prisoner may be the man I seek.")
      }else if (/*Goblin Cave*/){
        paladinText("I'm going to start with the ones in the cave. They can tell me what's going on, and if their prisoner is the man I seek. At the very least, I can do some justice for Gary's son.")
        addDlg("Harold: Alright, but be careful. That cave is known for its goblin presence, on top of the bad people we know are in there. It's about 7 miles northwest. If you follow the North road until you reach the lighting struck tree, then turn right you should reach it easily.")
        paladinText("Thank you so much for your hospitality and your helpfulness. I will try to repay it at some point.")
        addDlg("Harold: Repay me by dealing with the men that hurt Mark.")
        paladinText("I shall deal justice. Farewell.")
        addText("You leave that night and hurry on the North road. Sure enough after several miles you come across a huge old tree, hollowed by lighting. Perhaps it would be best to sleep for a few hours here before you continue to the cave?")
      }else{
        addText("try again")
      }
        break;
    }
  });
</script>
